<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Malware source code investigation: AsyncRAT - MSSP Lab</title>
<meta name="description" content="AsyncRAT is a Remote Access Trojan (RAT) designed to remotely monitor and control infected systems. It is free, open-source, and often used by cybercriminals for malicious purposes, such as stealing sensitive information, installing more malware, or performing DDoS attacks.">


  <meta name="author" content="MSSP Lab">
  
  <meta property="article:author" content="MSSP Lab">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="MSSP Lab">
<meta property="og:title" content="Malware source code investigation: AsyncRAT">
<meta property="og:url" content="http://localhost:4001/threat-hunting/2023/05/19/malware-src-asyncrat.html">


  <meta property="og:description" content="AsyncRAT is a Remote Access Trojan (RAT) designed to remotely monitor and control infected systems. It is free, open-source, and often used by cybercriminals for malicious purposes, such as stealing sensitive information, installing more malware, or performing DDoS attacks.">



  <meta property="og:image" content="http://localhost:4001/assets/images/3/asyncrat.png">



  <meta name="twitter:site" content="@MSSP Lab">
  <meta name="twitter:title" content="Malware source code investigation: AsyncRAT">
  <meta name="twitter:description" content="AsyncRAT is a Remote Access Trojan (RAT) designed to remotely monitor and control infected systems. It is free, open-source, and often used by cybercriminals for malicious purposes, such as stealing sensitive information, installing more malware, or performing DDoS attacks.">
  <meta name="twitter:url" content="http://localhost:4001/threat-hunting/2023/05/19/malware-src-asyncrat.html">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="http://localhost:4001/assets/images/3/asyncrat.png">
    
  

  



  <meta property="article:published_time" content="2023-05-19T05:00:00+03:00">





  

  


<link rel="canonical" href="http://localhost:4001/threat-hunting/2023/05/19/malware-src-asyncrat.html">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "MSSP Lab",
      "url": "http://localhost:4001/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="MSSP Lab Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          MSSP Lab
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">about</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4001/">
        <img src="/assets/images/mssp-logo-white.png" alt="MSSP Lab" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4001/" itemprop="url">MSSP Lab</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>cybersec lab. research and development</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="mailto:mssplab.uae@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://twitter.com/MSSPLab" rel="nofollow noopener noreferrer me"><i class="fab fa-twitter" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/MSSPLab/" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/company/mssp-lab/" rel="nofollow noopener noreferrer me"><i class="fab fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Malware source code investigation: AsyncRAT">
    <meta itemprop="description" content="AsyncRAT is a Remote Access Trojan (RAT) designed to remotely monitor and control infected systems. It is free, open-source, and often used by cybercriminals for malicious purposes, such as stealing sensitive information, installing more malware, or performing DDoS attacks.">
    <meta itemprop="datePublished" content="2023-05-19T05:00:00+03:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4001/threat-hunting/2023/05/19/malware-src-asyncrat.html" class="u-url" itemprop="url">Malware source code investigation: AsyncRAT
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <p>AsyncRAT is a Remote Access Trojan (RAT) designed to remotely monitor and control infected systems. It is free, open-source, and often used by cybercriminals for malicious purposes, such as stealing sensitive information, installing more malware, or performing DDoS attacks.</p>

<p><img src="/assets/images/3/asyncrat.png" alt="asyncrat" class="img-responsive" /></p>

<p><strong>AsyncRAT</strong> was published as an open source remote administration tool project on GitHub in January 2019.</p>

<p><img src="/assets/images/3/2023-05-20_12-39.png" alt="asyncrat" class="img-responsive" /></p>

<p><em>AsyncRAT</em> is a regular malware product and set of tools utilized by attackers and APT organizations. Threat actors and adversaries utilized a variety of intriguing script injectors and spear phishing attachments to deliver AsyncRAT to targeted hosts or networks across multiple campaigns.</p>

<p>In this small research we are detailed investigate the source code of <em>AsyncRAT</em> and highlights the main features.</p>

<p>AsyncRAT has been included in <a href="https://any.run/malware-trends/">app.any.run’s weekly TOP 10</a> malware trends tracker for the past few months.</p>

<p><img src="/assets/images/3/2023-05-20_12-41.png" alt="asyncrat" class="img-responsive" /></p>

<p><img src="/assets/images/3/2023-05-20_12-42.png" alt="asyncrat" class="img-responsive" /></p>

<h3 id="client-server-architecture">Client-Server Architecture</h3>

<p>When executed, the <em>AsyncRat GUI</em> allows criminals to control the infected machine. The code is open-source and can be modified to suit the purposes of criminals:</p>

<p><img src="/assets/images/3/2023-05-20_16-24.png" alt="asyncrat" class="img-responsive" /></p>

<p><em>AsyncRAT</em> implements a client-server architecture. The client side is the infected machine, whereas the server side is the attacker-operated control interface. The client establishes a connection with the server using asynchronous TCP sockets, which permits multiple simultaneous connections without interference.</p>

<p><img src="/assets/images/3/2023-05-20_13-58.png" alt="asyncrat" class="img-responsive" /></p>

<h3 id="core-functionalities">Core Functionalities</h3>

<p><em>AsyncRAT</em> includes several functionalities that permit a high degree of control over infected systems:</p>

<p><strong>Remote Desktop</strong> - The client captures screenshots of the desktop and sends them to the server, allowing the attacker to see the victim’s activities in real time.</p>

<p><em>AsyncRAT</em> uses the <code class="language-plaintext highlighter-rouge">.NET Framework</code>’s built-in libraries to capture screenshots from the victim’s machine. The following is a more technical breakdown of how this feature works in the <em>AsyncRAT</em> client.</p>

<p>In the <em>AsyncRAT</em>’s source code, you would find a function responsible for capturing screenshots. This function is typically invoked when the server sends a specific command to the client.</p>

<p>To capture the screenshot, <em>AsyncRAT</em> leverages the <code class="language-plaintext highlighter-rouge">System.Drawing</code> namespace in the <code class="language-plaintext highlighter-rouge">.NET Framework</code>, which provides access to <code class="language-plaintext highlighter-rouge">GDI+</code> basic graphics functionality. More specifically, it uses the <code class="language-plaintext highlighter-rouge">Bitmap</code> and <code class="language-plaintext highlighter-rouge">Graphics</code> classes to capture and store the screenshot(<code class="language-plaintext highlighter-rouge">/Plugin/Options/Options/Handler/HandleThumbnails.cs</code>):</p>

<p><img src="/assets/images/3/2023-05-20_14-02.png" alt="asyncrat" class="img-responsive" /></p>

<p>This code does the following:</p>

<ul>
  <li>
    <p>Creates a new <code class="language-plaintext highlighter-rouge">Bitmap</code> object with the same size as the screen. The <code class="language-plaintext highlighter-rouge">Screen.PrimaryScreen.Bounds</code> property is used to determine the size of the screen.</p>
  </li>
  <li>
    <p>Creates a <code class="language-plaintext highlighter-rouge">Graphics</code> object from the bitmap. This object is used to perform the screenshot operation.</p>
  </li>
  <li>
    <p>Uses the <code class="language-plaintext highlighter-rouge">Graphics.CopyFromScreen</code> method to take the screenshot. This method copies the pixels from the screen and stores them in the bitmap.</p>
  </li>
</ul>

<p>After the screenshot is captured and stored in the bitmap, <em>AsyncRAT</em> then usually converts the bitmap to a byte array and sends it to the server. The server can then reconstruct the bitmap from the byte array to view the screenshot. It’s worth noting that the screenshot is usually compressed before being sent to reduce network usage.</p>

<p><strong>Keylogger</strong> - AsyncRAT logs keystrokes and periodically sends the data to the server. This feature can capture sensitive information like passwords and credit card numbers.</p>

<p><em>AsyncRAT</em> captures keystrokes by using the <code class="language-plaintext highlighter-rouge">SetWindowsHookEx</code> function, which is part of the Windows API. This function allows the application to install a “hook” that monitors the message traffic in the system and retrieves specific types of messages, such as keypresses.</p>

<p>The following is a code of how <em>AsyncRAT</em> implement a keylogger in <code class="language-plaintext highlighter-rouge">C#</code> using the <code class="language-plaintext highlighter-rouge">SetWindowsHookEx</code> function (<code class="language-plaintext highlighter-rouge">Plugin/LimeLogger/LimeLogger/Packet.cs</code>):</p>

<p><img src="/assets/images/3/2023-05-20_14-09.png" alt="asyncrat" class="img-responsive" /></p>

<p>The <code class="language-plaintext highlighter-rouge">SetHook</code> function installs the keyboard hook by calling <code class="language-plaintext highlighter-rouge">SetWindowsHookEx</code> with the <code class="language-plaintext highlighter-rouge">LowLevelKeyboardProc</code> delegate. The hook is then uninstalled using <code class="language-plaintext highlighter-rouge">UnsetHook</code>:</p>

<p><img src="/assets/images/3/2023-05-20_14-11.png" alt="asyncrat" class="img-responsive" /></p>

<p><strong>File Explorer</strong> - The client can navigate the filesystem, upload files to the server, download files from the server, and execute files.</p>

<p>To accomplish these tasks, <em>AsyncRAT</em> uses standard <code class="language-plaintext highlighter-rouge">.NET Framework</code> libraries. Let’s break down each function separately.</p>

<p><em>Navigating the File System</em>. The <code class="language-plaintext highlighter-rouge">System.IO</code> namespace in the <code class="language-plaintext highlighter-rouge">.NET Framework</code> contains classes for manipulating files and directories. For example, <em>AsyncRAT</em> retrieve a list of files in a directory using the <code class="language-plaintext highlighter-rouge">Directory.GetFiles</code> method (<code class="language-plaintext highlighter-rouge">Plugin/FileSearcher/FileSearcher/Packet.cs</code>):</p>

<p><img src="/assets/images/3/2023-05-20_14-19.png" alt="asyncrat" class="img-responsive" /></p>

<p>And get subdirectories with <code class="language-plaintext highlighter-rouge">Directory.GetDirectories</code> method (<code class="language-plaintext highlighter-rouge">Plugin/FileManager/FileManager/Handler/FileManager.cs</code>):</p>

<p><img src="/assets/images/3/2023-05-20_14-20.png" alt="asyncrat" class="img-responsive" /></p>

<p><em>Uploading Files To the Server</em>. To read the contents of a file, <em>AsyncRAT</em> uses the <code class="language-plaintext highlighter-rouge">File.ReadAllBytes</code> method, which reads a file and returns its contents as a byte array (for example in <code class="language-plaintext highlighter-rouge">Plugin/FileSearcher/FileSearcher/Packet.cs</code>):</p>

<p><img src="/assets/images/3/2023-05-20_14-27.png" alt="asyncrat" class="img-responsive" /></p>

<p><em>Downloading Files from the Server</em>. When the server sends a file, it is usually in the form of a byte array. The client can save this byte array to a file using the <code class="language-plaintext highlighter-rouge">File.WriteAllBytes</code> method (for example in: <code class="language-plaintext highlighter-rouge">Server/HandlePacket/HandleFileSearcher.cs</code>):</p>

<p><img src="/assets/images/3/2023-05-20_14-31.png" alt="asyncrat" class="img-responsive" /></p>

<p><em>Executing Files</em>. To execute a file, <em>AsyncRAT</em> uses the <code class="language-plaintext highlighter-rouge">Process.Start</code> method from the <code class="language-plaintext highlighter-rouge">System.Diagnostics</code> namespace (<code class="language-plaintext highlighter-rouge">Plugin/FileManager/FileManager/Handler/FileManager.cs</code>):</p>

<p><img src="/assets/images/3/2023-05-20_14-34.png" alt="asyncrat" class="img-responsive" /></p>

<p><strong>Process Manager</strong> - The client retrieves a list of running processes and can kill or start processes.</p>

<p><em>AsyncRAT</em> utilizes the <code class="language-plaintext highlighter-rouge">System.Diagnostics</code> namespace in the <code class="language-plaintext highlighter-rouge">.NET Framework</code> to interact with system processes.
<em>Retrieving a List of Running Processes</em>. The <code class="language-plaintext highlighter-rouge">Process</code> class in the <code class="language-plaintext highlighter-rouge">System.Diagnostics</code> namespace has a static method <code class="language-plaintext highlighter-rouge">GetProcesses</code> that returns an array of <code class="language-plaintext highlighter-rouge">Process</code> objects, which represent all the processes currently running on the system. Here is how it’s used (<code class="language-plaintext highlighter-rouge">Plugin/ProcessManager/ProcessManager/Packet.cs</code>):</p>

<p><img src="/assets/images/3/2023-05-20_14-45.png" alt="asyncrat" class="img-responsive" /></p>

<p>also use <code class="language-plaintext highlighter-rouge">SELECT ProcessId, Name, ExecutablePath FROM Win32_Process</code> query:</p>

<p><img src="/assets/images/3/2023-05-20_14-46.png" alt="asyncrat" class="img-responsive" /></p>

<p><em>Starting a Process</em>. To start a new process, <em>AsyncRAT</em> uses the <code class="language-plaintext highlighter-rouge">Process.Start</code> method, which starts a process resource by specifying the name of an application or document:</p>

<p><img src="/assets/images/3/2023-05-20_14-49.png" alt="asyncrat" class="img-responsive" /></p>

<p>Note that all these operations require sufficient permissions. If the <em>AsyncRAT</em> client doesn’t have the necessary permissions, these operations will fail.</p>

<p><strong>Remote Shell</strong> - The client can execute shell commands from the server, enabling an even greater degree of control.</p>

<p>The ability to execute shell commands remotely is a powerful feature of <em>AsyncRAT</em>. This feature allows the attacker to execute virtually any command, as if they were physically present at the victim’s machine.</p>

<p><em>AsyncRAT</em> executes shell commands by using the <code class="language-plaintext highlighter-rouge">System.Diagnostics.Process</code> class in the <code class="language-plaintext highlighter-rouge">.NET Framework</code>. This class provides the <code class="language-plaintext highlighter-rouge">Start</code> method, which can start a new process. To execute a shell command, <em>AsyncRAT</em> starts a new instance of <code class="language-plaintext highlighter-rouge">cmd.exe</code> with the shell command as a parameter (<code class="language-plaintext highlighter-rouge">Plugin/Miscellaneous/Miscellaneous/Handler/HandleShell.cs</code>):</p>

<p><img src="/assets/images/3/2023-05-20_15-22.png" alt="asyncrat" class="img-responsive" /></p>

<h3 id="stealth-and-persistence">Stealth and Persistence</h3>

<p>To evade detection, <em>AsyncRAT</em> uses several techniques:</p>

<p><strong>Process Injection</strong> - <em>AsyncRAT</em> injects its core functionality into a separate process to hide its malicious activities.</p>

<p>The injector is used to load into the memory the <em>AsyncRAT</em> file by taking advantage of the <a href="https://attack.mitre.org/techniques/T1055/012/">Process Hollowing</a> technique. As demonstrated, a new thread is created, put in a suspended state (pause), the target file mapped into the memory, and then executed:</p>

<p><img src="/assets/images/3/2023-05-20_16-06.png" alt="asyncrat" class="img-responsive" /></p>

<p><img src="/assets/images/3/2023-05-20_15-57.png" alt="asyncrat" class="img-responsive" /></p>

<p><strong>Anti-Analysis</strong> - The client employs various anti-analysis techniques, including the detection of virtual machines and sandbox environments.</p>

<p>Malware often employs anti-analysis techniques to evade detection, avoid being analyzed in a controlled environment, and ultimately to make reverse-engineering more challenging. This includes checks for virtual machines (VMs) and sandbox environments, which are commonly used tools for malware analysis.</p>

<p>Analyzing the source code of <em>AsyncRAT</em>, you may find various techniques that it employs to achieve this (<code class="language-plaintext highlighter-rouge">Client/Helper/Anti_Analysis.cs</code>). While specific implementation details could vary depending on the version or variant of the RAT, here’s an example of what these anti-analysis checks might look like in practice.</p>

<p>Here is how AsyncRAT check for a VM and a sandbox:</p>

<p><img src="/assets/images/3/2023-05-20_16-08.png" alt="asyncrat" class="img-responsive" /></p>

<p><img src="/assets/images/3/2023-05-20_16-13.png" alt="asyncrat" class="img-responsive" /></p>

<p>As you can see, just check if <code class="language-plaintext highlighter-rouge">Sbiedll.dll</code> is loaded, which is a module of sandboxie sandbox.</p>

<p>Also check disk size:</p>

<p><img src="/assets/images/3/2023-05-20_16-11.png" alt="asyncrat" class="img-responsive" /></p>

<p>The logic is simple, determine if a compromised host is operating in a malware lab or sandbox by examining the size of its hard drive.</p>

<p>Another method is <code class="language-plaintext highlighter-rouge">IsXP</code>: check if its process is running in <code class="language-plaintext highlighter-rouge">XP Windows</code> Operating System:</p>

<p><img src="/assets/images/3/2023-05-20_16-12.png" alt="asyncrat" class="img-responsive" /></p>

<p>Check if remote debugger exist:</p>

<p><img src="/assets/images/3/2023-05-20_16-14.png" alt="asyncrat" class="img-responsive" /></p>

<p>The following image depicts the code that drops a <code class="language-plaintext highlighter-rouge">.bat</code> script in the <code class="language-plaintext highlighter-rouge">%temp%</code> folder to delete itself as part of a defense evasion technique to clear its trace after execution and drop a copy of itself on the compromised host:</p>

<p><img src="/assets/images/3/2023-05-20_16-21.png" alt="asyncrat" class="img-responsive" /></p>

<p><strong>Persistence</strong> - The client installs itself to the registry or startup folder to maintain persistence after system reboots.</p>

<p>The <em>AsyncRAT</em> client will verify that its code executes with administrative permissions. If so, it will add Windows Scheduled Tasks using <code class="language-plaintext highlighter-rouge">schtasks.exe</code> with the highest runlevel permissions to execute a duplicate of itself, if <em>AsyncRAT</em> is not running with administrative privileges, it will use Registry Run Key <code class="language-plaintext highlighter-rouge">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code> for its persistence:</p>

<p><img src="/assets/images/3/2023-05-20_16-28.png" alt="asyncrat" class="img-responsive" /></p>

<h3 id="connection-and-control">Connection and Control</h3>

<p>On execution, the client initiates a connection to the server. After a successful connection, the client sends detailed system information to the server, including the computer name, user name, operating system, processor, and installed antivirus software. The client also downloads a small <code class="language-plaintext highlighter-rouge">.NET</code> assembly DLL file from the server, which is injected into a newly created process. This is where the <em>AsyncRAT</em>’s core functionality is executed.</p>

<p><em>AsyncRAT</em> will decrypt its AES encrypted configuration data including the port and C2 IP address that will be used for C2 communication:</p>

<p><img src="/assets/images/3/2023-05-20_16-49.png" alt="asyncrat" class="img-responsive" /></p>

<p>This is the code snippet for C2 server communication and C2 downloads:</p>

<p><img src="/assets/images/3/2023-05-20_16-53.png" alt="asyncrat" class="img-responsive" /></p>

<h3 id="updating-and-uninstalling">Updating and Uninstalling</h3>

<p><em>AsyncRAT</em> allows for the updating and uninstalling of the client directly from the server.</p>

<p><img src="/assets/images/3/2023-05-20_17-03.png" alt="asyncrat" class="img-responsive" /></p>

<p>The uninstall functionality would typically involve the server sending a command to the client, telling it to remove itself from the infected machine. This might involve deleting the client binary, as well as any other files created by the client. The client might also remove any registry keys it has created, and undo any other changes it has made to the system.</p>

<h3 id="conclusion">Conclusion</h3>

<p>Given its open-source nature and availability on GitHub since January 2019, <em>AsyncRAT</em> is accessible to a wide range of threat actors, including both individual malicious actors and sophisticated APT groups. This availability, combined with its powerful features, makes it a popular choice for cybercriminals.</p>

<p>The observed campaigns leveraging spear-phishing attacks and script loaders, such as the one using a Microsoft OneNote attachment to load a <code class="language-plaintext highlighter-rouge">.HTA</code> file, demonstrate that attackers can employ a variety of methods to deliver <em>AsyncRAT</em> to targeted hosts or networks. This underlines the importance of a comprehensive security posture, encompassing not just malware detection and removal, but also employee training and robust email security measures to combat spear-phishing attacks.</p>

<p>By Cyber Threat Hunters from MSSPLab:</p>

<ul>
  <li><a href="https://www.linkedin.com/in/zhassulan-zhussupov-5a347419b/">@cocomelonc</a></li>
  <li><a href="https://www.linkedin.com/in/aruzhan-kaldybek-775735226">@wqkasper</a></li>
</ul>

<h3 id="references">References</h3>

<p><a href="https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp">https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp</a>   <br />
<a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.asyncrat">https://malpedia.caad.fkie.fraunhofer.de/details/win.asyncrat</a>   <br />
<a href="https://twitter.com/anyrun_app/status/1617401778240102400?s=20&amp;t=ED5KEvCMTz8_F2IjR61j8Q">https://twitter.com/anyrun_app/status/1617401778240102400</a>    <br />
<a href="https://any.run/malware-trends/">https://any.run/malware-trends/</a>     <br />
<a href="https://attack.mitre.org/techniques/T1055/012/">MITRE ATT&amp;CK: Process Hollowing</a>   <br />
<a href="https://research.splunk.com/stories/asyncrat/">https://research.splunk.com/stories/asyncrat/</a></p>

<p>Thanks for your time happy hacking and good bye!       <br />
<em>All drawings and screenshots are MSSPLab’s</em></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#blueteam" class="page__taxonomy-item p-category" rel="tag">blueteam</a><span class="sep">, </span>
    
      <a href="/tags/#malware" class="page__taxonomy-item p-category" rel="tag">malware</a><span class="sep">, </span>
    
      <a href="/tags/#malwareanalysis" class="page__taxonomy-item p-category" rel="tag">malwareanalysis</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#threat-hunting" class="page__taxonomy-item p-category" rel="tag">threat-hunting</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2023-05-19T05:00:00+03:00">May 19, 2023</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=MSSP+Lab&text=Malware+source+code+investigation%3A+AsyncRAT%20http%3A%2F%2Flocalhost%3A4001%2Fthreat-hunting%2F2023%2F05%2F19%2Fmalware-src-asyncrat.html" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4001%2Fthreat-hunting%2F2023%2F05%2F19%2Fmalware-src-asyncrat.html" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4001%2Fthreat-hunting%2F2023%2F05%2F19%2Fmalware-src-asyncrat.html" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/threat-hunting/2023/05/08/malware-analysis-windealer.html" class="pagination--pager" title="Malware analysis report: WinDealer (LuoYu Threat Group)
">Previous</a>
    
    
      <a href="/threat-hunting/2023/06/02/malware-analysis-apt29.html" class="pagination--pager" title="Malware analysis report: SNOWYAMBER (+APT29 related malwares)
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You may also enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/9/blacklotus.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/threat-hunting/2023/07/15/malware-src-blacklotus.html" rel="permalink">Malware source code investigation: BlackLotus - part 1
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          13 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">BlackLotus is a UEFI bootkit that targets Windows and is capable of evading security software, persisting once it has infected a system, bypassing Secure Boo...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/8/blackcat.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/threat-hunting/2023/07/13/malware-analysis-blackcat.html" rel="permalink">Malware analysis report: BlackCat ransomware
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          10 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">BlackCat is Rust-based ransomware distributed via the Ransomware-as-a-Service (RaaS) model. BlackCat was observed for the first time in November 2021 and has...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/7/2023-07-03_09-10.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/open-source/2023/07/03/open-source-1.html" rel="permalink">DEFC: simple enumeration tool for detect AV/EDR
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Hello, cybersecurity enthusiasts and white hackers!

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/6/paradise-ransom.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/threat-hunting/2023/06/23/src-paradise.html" rel="permalink">Malware source code investigation: Paradise Ransomware
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Paradise Ransomware is a type of malware that encrypts the files on the victims’ systems and then demands a ransom to recover the data. This ransomware famil...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/MSSPLab" rel="nofollow noopener noreferrer"><i class="fab fa-twitter" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/MSSPLab/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/company/mssp-lab/" rel="nofollow noopener noreferrer"><i class="fab fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 MSSP Lab. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
